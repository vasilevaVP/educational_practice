<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Geologica:wght@100..900&display=swap" rel="stylesheet">
        <title>Регистрация</title>
        <link rel="icon" href="./img/iconlogo.ico">
    </head>
       <style>
        body {
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            height: 100vh;
            font: 200 15px Geologica;
            background-color: #eeeadf;
            margin: 0;
        }

        .form-container {
            background-color: #fefefe;
            padding: 30px;
            border-radius: 10px;
            width: 643px;
            height: auto;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        h1 {
            font:  600 32px Geologica;
            text-align: center;
            margin-bottom: 60px;
            color: #200E49;
        }

         .input-group {
            margin-bottom: 20px;
            text-align: center;
        }

        .password {
	width: 100%;
	margin: 15px auto;
	position: relative;
    padding: 5px 0;
	height: 30px;
	line-height: 40px;
	text-indent: 10px;
	margin: 0 0 15px 0;
	border-radius: 5px;
	border: 1px solid #999;
	font-size: 18px;
}

.password-control {
	position: absolute;
	top: 9px;
    right: 155px;
	display: inline-block;
	width: 20px;
	height: 20px;
	background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' viewBox='0 0 24 24'%3E%3Cg fill='none' stroke='%23535353' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5'%3E%3Cpath d='M3 13c3.6-8 14.4-8 18 0'/%3E%3Cpath d='M12 17a3 3 0 1 1 0-6a3 3 0 0 1 0 6'/%3E%3C/g%3E%3C/svg%3E") 0 0 no-repeat;
}
.password-control.view {
	background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='22' height='22' viewBox='0 0 24 24'%3E%3Cg fill='none' stroke='%23363636' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5'%3E%3Cpath d='M3 13c3.6-8 14.4-8 18 0'/%3E%3Cpath fill='%23363636' d='M12 17a3 3 0 1 1 0-6a3 3 0 0 1 0 6'/%3E%3C/g%3E%3C/svg%3E") 0 0 no-repeat;
}
      
        .input-group input[type="email"],
        .input-group input[type="password"],
        .input-group input[type="text"] {
            width: 370px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 5px;
            box-sizing: border-box;
            font: 200 15px Geologica;
        }
         .input-group .password-container{
            position: relative;
         }


        .input-group input[type="text"].invalid,
         .input-group input[type="email"].invalid,
         .input-group .password-container input[type="password"].invalid{
            border-color: red;
            font: 200 14px Geologica;
        }

        .error {
            color: red;
            margin-top: 5px;
            display: block;
            font: 200 14px Geologica;
        }

        input[type="submit"] {
            width:fit-content;
            height:fit-content;
            padding: 20px;
            background-color: #5b8dc8;
            border: none;
            margin: 0 auto;
            text-align: center;
            border-radius: 10px;
            font:  400 14px Geologica;
            color: rgb(255, 255, 255);
            margin-top: 30px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        input[type="submit"]:hover {
            background-color: #0056b3;
        }

        .auth-link {
           text-align: center;
           margin-top: 30px;
           font-size: 0.9em;
           font: 200 15px Geologica;
        }
             .password-toggle {
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            cursor: pointer;
             user-select: none;
        }
        .close {
  color: #606060;
  float: left;
  font: 200 14px Geologica;
}
.close:hover,
.close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

.user-type-selector{
    margin-bottom: 10px;
}
.password-rules {
    font-size: 12px;
    color: #666;
margin-left: 140px;
    text-align: left;
}

.password-rules ul {
    padding-left: 20px;
    margin: 5px 0;
}

.password-rules li.valid {
    color: green;
    text-decoration: line-through;
}
/* Адаптив для мобильных устройств (до 768px) */
@media (max-width: 768px) {
    body {
        padding: 20px;
        height: auto;
        min-height: 100vh;
        align-items: flex-start;
    }

     .profession-field {
        margin-bottom: 15px;
    }
    
    .terms-text {
        text-align: center;
        margin: 15px 0;
    }
    .form-container {
        width: 100%;
        max-width: 100%;
        padding: 30px 20px;
        margin: 20px 0;
        box-shadow: none;
        border: 1px solid #ddd;
    }

    h1 {
        font-size: 1.5rem;
        margin-bottom: 30px;
    }

    .input-group input[type="email"],
    .input-group input[type="password"],
    .input-group input[type="text"] {
        width: 100%;
        max-width: 100%;
        box-sizing: border-box;
    }

    .password-control {
        right: 15px !important;
    }

    .password-rules {
        margin-left: 0 !important;
    }

    .auth-link {
        margin-top: 20px;
    }

    input[type="submit"] {
        width: 100%;
        padding: 15px;
    }

    .close {
        margin-bottom: 15px;
        display: inline-block;
    }
}

/* Для очень маленьких экранов (до 480px) */
@media (max-width: 480px) {
    .form-container {
        padding: 25px 15px;
    }

    h1 {
        font-size: 1.3rem;
        margin-bottom: 25px;
    }

    .user-type-selector {
        display: flex;
        flex-direction: column;
        gap: 10px;
        align-items: flex-start;
    }

    .password-rules ul {
        padding-left: 15px;
    }
}

    </style>
<body>
    
    <div class="form-container">
        <a href="/index"><span class="close" id="closeConfirm">← На главную</span></a>
    <h1>Регистрация</h1>
        <% if (error) { %>
        <p class="error"><%= error %></p>
        <% } %>
        <form method="post" action="/register">
                        <!-- Выбор типа пользователя -->
                        <div class="user-type-selector">
                            <label>
                                <input type="radio" name="userType" value="teacher" required> Педагог
                            </label>
                            <label>
                                <input type="radio" name="userType" value="student"> Учащийся
                            </label>
                        </div>
                        
                        <!-- Поле профессии (только для учителей) -->
                        <div class="input-group profession-field" id="professionField">
                            <input type="text" id="profession" name="profession" placeholder="Ваша профессия (например, учитель математики)">
                        </div>
            <div class="input-group">
                <input type="text" id="fullName" name="fullName" placeholder="Введите ФИО" required>
            </div>
            
            <div class="input-group">
                <input type="email" id="email" name="email" placeholder="Введите почту" required>
            </div>
            
            <div class="input-group">
                <div class="password-container">
                    <input type="password" id="password" name="password" placeholder="Введите пароль" required>
                    <a href="#" class="password-control" onclick="return show_hide_password(this);"></a>
                </div>
            </div>
            
            <div class="input-group">
                <div class="password-container">
                    <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Повторите пароль" required>
                    <a href="#" class="password-control" onclick="return show_hide_password2(this);"></a>
                </div>
            </div>
            <div class="input-group">
                <div class="password-rules">
                    <p>Пароль должен содержать:</p>
                    <ul>
                        <li id="length-rule">Минимум 8 символов</li>
                        <li id="digit-rule">Хотя бы 1 цифру</li>
                        <li id="letter-rule">Хотя бы 1 букву</li>
                    </ul>
                </div>
            </div>
            
            <p class="terms-text">
                Регистрируясь, вы соглашаетесь с обработкой персональных данных
            </p>
            
            <input type="submit" value="Зарегистрироваться">
        </form>
        
        <div class="auth-link">
            <p>Уже есть аккаунт? <a href="/login">Войти</a></p>
        </div>
    </div>

    <script>
        // Показываем/скрываем поле профессии
        document.querySelectorAll('input[name="userType"]').forEach(radio => {
            radio.addEventListener('change', function() {
                const professionField = document.getElementById('professionField');
                if (this.value === 'teacher') {
                    professionField.style.display = 'block';
                    document.getElementById('profession').setAttribute('required', '');
                } else {
                    professionField.style.display = 'none';
                    document.getElementById('profession').removeAttribute('required');
                }
            });
        });
        
// Валидация пароля в реальном времени
document.getElementById('password').addEventListener('input', function() {
    const password = this.value;
    const lengthValid = password.length >= 8;
    const hasDigit = /\d/.test(password);
    const hasLetter = /[a-zA-Zа-яА-Я]/.test(password);
    
    document.getElementById('length-rule').classList.toggle('valid', lengthValid);
    document.getElementById('digit-rule').classList.toggle('valid', hasDigit);
    document.getElementById('letter-rule').classList.toggle('valid', hasLetter);
});

// Проверка перед отправкой формы
document.getElementById('registerForm').addEventListener('submit', function(e) {
    const password = document.getElementById('password').value;
    
    if (password.length < 8 || !/\d/.test(password) || !/[a-zA-Zа-яА-Я]/.test(password)) {
        e.preventDefault();
        alert('Пароль не соответствует требованиям');
    }
});
        function show_hide_password(target) {
            const input = document.getElementById('password');
            if (input.getAttribute('type') == 'password') {
                target.classList.add('view');
                input.setAttribute('type', 'text');
            } else {
                target.classList.remove('view');
                input.setAttribute('type', 'password');
            }
            return false;
        }
        
        function show_hide_password2(target) {
            const input = document.getElementById('confirmPassword');
            if (input.getAttribute('type') == 'password') {
                target.classList.add('view');
                input.setAttribute('type', 'text');
            } else {
                target.classList.remove('view');
                input.setAttribute('type', 'password');
            }
            return false;
        }
    </script>
</body>
</html>